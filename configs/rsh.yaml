---
model: hedonicmodel
table: dset.buildings
internalname: buildings
filters:
    - buildings.residential_units > 0
    - buildings.year_built > 1900
merge:
    table: dset.parcels
    left_on: parcel_id
    right_index: True
dep_var: improvement_value
dep_var_transform: np.log
segment:
    - building_type_id
patsy:
    - I(year_built < 1940)
    - I(year_built > 2005)
    - np.log1p(sqft_per_unit)
    - np.log(residential_units)
    - C(floodprone)
    - np.log1p(parcel_sqft)
add_constant: yes
output_table: dset.buildings
output_varname: residential_improvement_value
output_transform: np.exp
